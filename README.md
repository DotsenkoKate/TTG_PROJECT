# TTG Project ver 1.0
## Область применения проекта: 
  Маршрутные транспортные средства
## Краткая информация
  Приложение выступает дополнением к таким гигантам, как яндекс.карты и 2гис. Оно позволяет приблизительно отслеживать движение маломестных маршрутных ТС (маршруток), 
  что не позволяют сделать уже имеющиеся приложения. Пользователи приложения будут разделяться на категории (далле жирным шрифтом). **Водитель** будет отмечать у себя на устройстве остановку, которую он миновал,  **пассажир** тут же будет это наблюдать 
  на своём устройстве. Также приложение несёт в себе информативный характер: **владелец** маршрута сможет видеть состояние автомобилей, все свои маршруты, остановки маршрутов 
  и закреплённых за маршрутом водителей, пассажир сможет наблюдать движение маршруток по остановкам, узнавать остановки маршрутов, стоимость проезда и время работы машин 
  на маршруте. Незарегистрированный пользователь (**гость**) будет обладать теми же возможностями, что и пассажир, за исключением, возможности оставить отзыв.
## Функциональные требования
1. Регистрация и вход (для всех пользователей)

_Для пассажира или гостя:_
1. Ввод маршрута
2. Вывод стоимости проезда
3. Вывод среднего времени движения авто от конечной до конечной
4. Вывод всех остановок маршрута
5. Вывод рейсов
6. Оставить отзыв (гость не может оставить отзыв!)

_Для водителя:_
1. Начать/завершить маршрут
2. Вывод интерактивного списка остановок, которые он должен проехать
3. Вывод информации о машине
4. Функция "Закрепить автомобиль"
5. Функция "Изменить статус авто"
6. Вывод расписания
7. Оставить информацию владельцу

_Для владельца:_
1. Вывод доступных маршрутов
2. Вывод остановок маршрута
3. Вывод машин маршрута
4. Вывод водителей маршрута
5. Добавление/изменение/удаление маршрута
6. Добавление/изменение/удаление остановок маршрута
7. Добавление/изменение/удаление машин маршрута
8. Вывод среднего времени движения по маршруту
9. Сделать заметку
10. Просмотреть список сообщений/удалить сообщение

> Use-case диаграмма функциональных требований:

![usecase](https://github.com/DotsenkoKate/TTG_PROJECT/blob/main/Pictures/UseCaseTTG.png)

## Сущности БД и Er-diagrams
_Для 1 БД (более статичные данные):_
1. Владелец
2. Маршрут
3. Остановка
4. Авто
5. Водитель
6. Расписание
7. Связь расписания и водителя
8. Связь маршрута и остановки

> ER-диаграмма
![er1](https://github.com/DotsenkoKate/TTG_PROJECT/blob/main/Pictures/ErDiag_bd1_withAtr_1_1.png)

_Для 2 БД (более динамичные данные):_
1. Пользователь
2. Рейс
3. Преодоление остановок
4. Динамический список информирования

> ER-диаграмма
![er2](https://github.com/DotsenkoKate/TTG_PROJECT/blob/main/Pictures/ErDiag_bd2.png)

## Запросы к БД

- Добавление нового пользователя
- Проверка данных для входа пользователя
- Получить остановки маршрута
- Получить стоимость проезда маршрута
- Получить среднее время движения по маршруту за последний месяц
- Получить информацию о времени преодоления остановок на маршруте
- Отправить отзыв/заметку/информацию
- Записать в бд рейс (создать запись в таблице trip и несколько записей в таблице Divide of trip)
- Получить информацию о машине
- Изменить поле driver_id в таблице Auto (закрепить водителя за тс)
- Изменить статус авто
- Получить рабочее время 
- Получить все маршруты владельца
- Получить все машины маршрута
- Получить всех водителей маршрута
- Добавить/изменить/удалить маршрут
- Добавить/изменить/удалить остановку маршрута
- Добавить/изменить/удалить машину маршрута
- Получить список сообщений/заметок
- Удалить сообщение/заметку

## Наша команда и задачи

Разработкой занимается 2 человека: ***Доценко Екатерина*** и ***Кирпа Андрей***

> Задачи команды и процесс их выполнения: [наши задачи](https://trello.com/b/kCOHSWFw/ttg-субд-project)

## Схема созданной базы данных в СУБД PostgreSQL

> ![schema](https://github.com/DotsenkoKate/TTG_PROJECT/blob/main/Pictures/DB_schema.png)

## Нефункциональные требования

_Для пассажира или гостя:_
Пользователь вводит в специальное поле номер маршрута, сервер запрашивает у БД Postgre все остановки с номером введенного маршрута, стоимость проезда, среднее время движения по маршруту, а у БД mongoDB - последные 5 рейсов маршрута. Зарегистрированный пользователь может оставить комментарий по улучшению качества перевозок или жалобу, приложение-клиент посылает серверу номер маршрута и сообщение, сервер записывает в БД сообщение в таблицу по номеру маршрута.

_Для водителя:_
Нажав на кнопку "Начать рейс" на экране появляется интерактивный список остановок. Преодолев определенную остановку, пользователь нажимает на нее в списке, и в контейнер заносится запись со временем и id остановки. Когда последняя остановка будет отмечена, рейс будет считаться завершенным, и весь заполненный контейнер будет передаваться в нереляционную БД. Сразу после входа в свой аккаунт, водитель сможет увидеть информацию о машине, которая берется из БД по логину пользователя, свое расписание, а также сможет изменить статус своего автомобиля нажатием на кнопку, сервер при этом, получив от клиента номер закрепленной авто, дает запрос на изменение таблицы в БД. Отзыв водитель оставляет по тому же принципу что и пассажиры.

_Для владельца:_
Сразу после того, как владелец залогинился, он видит у себя на экране свои маршруты. Нажав на один из маршрутов, сервер запросит у БД данные об остановках, среднему времени, водителях и машинах маршрута. В веб-версии владелец сможет редактировать маршруты, остановки и машины маршрута. В зависимости от выбранного действия (добавить/изменить/удалить) в БД отправляется соответствующий запрос. Также владелец может оставить сам себе заметку. Вместе с сообщениями от пассажиров и водителей владелец может оставлять собственные заметки, и все эти записи хранятся в одной таблице до того момента, как владелец не сочтет их актуальными и не удалит из списка.
